<!DOCTYPE html>
<html>
 <head>
  <title>Conditional Linked Data</title>
  <meta charset="utf-8">
  <meta name="author" content="Victor Rodriguez Doncel, Daniel Vila Suero"/>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="/css/vroddon.css">
  <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
  <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
  
  <link href="css/fileinput.css" media="all" rel="stylesheet" type="text/css" />
  <script src="js/fileinput.min.js" type="text/javascript"></script  
  
 </head>
<body>
	
<nav class="navbar navbar-inverse navbar-fixed-top">
  <div class="container-fluid">
    <div class="navbar-header">
      <a class="navbar-brand" href="/">
	  <img src="/img/rdf-condicional.png" width="24" style="float:left;margin:0px"/ > Conditional Linked Data
	  </a>
    </div>
    <div>
      <ul class="nav navbar-nav">
        <li><a href="/user">Demo User</a></li>
        <li><a href="/admin">Demo Manager</a></li> 
        <li><a href="/develop.html">Develop</a></li> 
      </ul>
	   <ul class="nav navbar-nav navbar-right">
        <li><a href="/account"><span class="glyphicon glyphicon-log-in"></span> Account</a></li>
      </ul>
    </div>
  </div>
</nav>
	
	
<div class="container">
 <div class="jumbotron">
	<center><h1>Conditional Linked Data</h1> 
    <p>A policy-based linked data server </p></center>
 </div>	
  <div class="col-md-2">
  </div>
  <div class="col-md-9">
<div class="ldrheading"><p>What is Conditional Linked Data?</p></div>
<p class="lead"><strong>Conditional Linked Data</strong> serves conditional Linked Data with access control based on ODRL policies. These pages demonstrate the <strong>conditional access to Linked Data</strong> </p>

<div class="ldrheading"><p>Choose a dataset to be served</p></div>

<div class="panel panel-default">
<div class="panel-body">
<table class="table ">
    <thead>
      <tr>
        <th>Short</th>
        <th>Datasets</th>
        <th>Description</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
<!--TEMPLATEDATASETS-->	
    </tbody>
  </table>
<!--TEMPLATEADDITIONALPORTALBUTTONS-->  
  
  
  </div>
</div>
</div> <!-- fin del espacio grande -->
  
  <div class="col-md-1">
  </div>
  
 
</div> <!-- fin de el container-->
  
<footer style="margin-top: 30px">
	<p><center><small> <a href="http://www.oeg-upm.net">2015 Ontology Engineering Group</a> - Universidad Politecnica de Madrid - All Rights Reserved. Attribution of data shown in this page is given in the about page</small></center></p>
</footer>


<script type="text/javascript">

var seldataset = '';

function submitform1(dataset, action)
{
  //  var pgn = document.getElementById("pgn").value;
  //  var pgnencoded = encodeURI(pgn);
  //  console.info(pgn);
  //  var params = "pgn=" + pgnencoded+"&action=enrich";
    var params="action="+action;
	params+="&dataset="+dataset;
	seldataset=dataset;
	
/*	
	console.info("Accion sobre: " +dataset+ " Accion: "+action);
    var http = new XMLHttpRequest();
    http.open("POST", "/service/portalAction", true); //true
    http.setRequestHeader("Content-type","application/x-www-form-urlencoded;charset=UTF-8");
    http.setRequestHeader("Content-length", params.length);    
    http.setRequestHeader("Connection", "close");
    http.send(params);
*/	
	
	$('#editDataset').modal('show');
}
</script>  
  
<!-- probando... -->

<!-- DIALOGO PARA EDITAR EL DATASET -->
<div class="modal fade" id="editDataset" tabindex="-1" role="dialog" aria-labelledby="editDataset" aria-hidden="true">
  <div class="modal-dialog modal-md">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <h4 class="modal-title" id="myModalLabel">Edit Dataset</h4>
      </div>
      <div class="modal-body">
        <h3>Edit Dataset</h3>
		  <div class="form-group">
			<label for="shortTitle">Short label</label>
			<input id="shortTitle" class="form-control" placeholder="Examples: 'geo', 'iate', 'apertium'" required>
		  </div>		
		  <div class="form-group">
			<label for="title">Title</label>
			<input id="title" class="form-control" placeholder="Examples: 'XYZ Terminology', 'A Dictionary of French'" required>
		  </div>		
		  <div class="form-group">
			<label for="description">Description</label>
			<textarea id="description" class="form-control" rows="3" placeholder="This dataset describes lore ipsum.." ></textarea>
		  </div>		
		  
		  <input id="input-1a" type="file" class="file" data-show-preview="false">
		  
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
        <button type="button" onclick="myFunction1()" data-dismiss="modal" class="btn btn-primary">OK</button>
      </div>
    </div>
  </div>
</div>



<!-- FIN DEL DIALOGO PARA EL DATASET -->
	
<script> <!-- Este codigo se ejecuta cuando se abre el dialogo modal -->
var recipient = -1;
$('#editDataset').on('show.bs.modal', function (event) {
  var button = $(event.relatedTarget) // Button that triggered the modal
//  recipient = button.data('data-miid') // Extract info from data-* attributes
//  alert("Hello! I am an alert box!!"+recipient+" - "+button.id);
  // If necessary, you could initiate an AJAX request here (and then do the updating in a callback).
  // Update the modal's content. We'll use jQuery here, but you could use a data binding library or other methods instead.
//  var modal = $(this)
//  modal.find('shortTitle').text('asdf');

	var xmlhttp=new XMLHttpRequest(); 
	xmlhttp.onreadystatechange=function()
	{
		if (xmlhttp.readyState==4 && xmlhttp.status==200)
		{
			//document.getElementById("myDiv").innerHTML=xmlhttp.responseText;
			var json = JSON.parse( xmlhttp.responseText );
			document.getElementById('shortTitle').value=json.label;
			document.getElementById('title').value=json.title;
			document.getElementById('description').value=json.description;
		}
	}
	xmlhttp.open("GET","/service/describeDataset?dataset="+seldataset,true);
	xmlhttp.setRequestHeader( 'Content-Type', 'application/json' );	
	xmlhttp.send();	


//  modal.find('.modal-title').text('New message to ' + recipient)
//  modal.find('.modal-body input').val(recipient) //
})
//este codigo se ejecuta cuando se ha dado al OK
function myFunction1() {
		var label = document.getElementById("shortTitle").value;
		var description = document.getElementById("description").value;
		var title = document.getElementById("title").value;

		console.info(description);
		
		var params="dataset="+seldataset;
		params+="&title="+title;
		params+="&description="+description;
		params+="&newlabel="+label;

		var http = new XMLHttpRequest();
		http.onreadystatechange=function()
		{
			location.reload();
		}		
		http.open("POST", "/service/setDatasetMetadata", true); //true		
		http.setRequestHeader("Content-type","application/x-www-form-urlencoded;charset=UTF-8");
		http.setRequestHeader("Content-length", params.length);    
		http.setRequestHeader("Connection", "close");
		http.send(params);
		
		$("#input-1a").fileinput({
			uploadUrl: "http://www.google.es", // server upload action
			uploadAsync: true,
			maxFileCount: 5
		});		
		
		
}
</script>	

<!-- fin de probando -->  
  
  
  
</body>
</html>